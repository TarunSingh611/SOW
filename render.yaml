services:
  - type: web
    name: sow-project
    env: node
    buildCommand: |
      cd client && npm install
      npm run build
      cd ../server && npm install
    startCommand: cd server && npm install pm2 -g && pm2 start ecosystem.config.js --env production
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
    healthCheckPath: /health
    autoDeploy: true
    # Add scaling configuration
    scaling:
      minInstances: 1
      maxInstances: 3
    # Add resource limits
    resources:
      cpu: 0.5
      memory: 512MB
    # Add environment variables for better monitoring
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: LOG_LEVEL
        value: info
